
<!DOCTYPE html>

<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<link href="https://www.ovn.org/ovn-kubernetes/features/multiple-networks/multi-homing/" rel="canonical"/>
<link href="../../infrastructure-security-controls/node-identity/" rel="prev"/>
<link href="../multi-network-policies/" rel="next"/>
<link href="../../../images/ovn-inside-k8s.png" rel="icon"/>
<meta content="mkdocs-1.6.1, mkdocs-material-9.7.1" name="generator"/>
<title>Multihoming - OVN-Kubernetes</title>
<link href="../../../assets/stylesheets/main.484c7ddc.min.css" rel="stylesheet"/>
<link href="../../../assets/stylesheets/palette.ab4e12ef.min.css" rel="stylesheet"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Inter:300,300i,400,400i,700,700i%7CJetBrains+Mono:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/>
<style>:root{--md-text-font:"Inter";--md-code-font:"JetBrains Mono"}</style>
<link href="../../../stylesheets/extra.css" rel="stylesheet"/>
<script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
</head>
<body data-md-color-accent="light-blue" data-md-color-primary="blue" data-md-color-scheme="default" dir="ltr">
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#multihoming">
          Skip to content
        </a>
</div>
<div data-md-component="announce">
</div>
<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
<nav aria-label="Header" class="md-header__inner md-grid">
<a aria-label="OVN-Kubernetes" class="md-header__button md-logo" data-md-component="logo" href="../../.." title="OVN-Kubernetes">
<img alt="logo" src="../../../images/ovn-inside-k8s.png"/>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
            OVN-Kubernetes
          </span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
            
              Multihoming
            
          </span>
</div>
</div>
</div>
<form class="md-header__option" data-md-component="palette">
<input aria-label="Blueprint" class="md-option" data-md-color-accent="light-blue" data-md-color-media="(prefers-color-scheme: light)" data-md-color-primary="blue" data-md-color-scheme="default" id="__palette_0" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_1" hidden="" title="Blueprint">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M8.5 3A5.5 5.5 0 0 1 14 8.5c0 1.33-.47 2.55-1.26 3.5H21v9h-9v-8.26c-.95.79-2.17 1.26-3.5 1.26A5.5 5.5 0 0 1 3 8.5 5.5 5.5 0 0 1 8.5 3"></path></svg>
</label>
<input aria-label="Nerve Center" class="md-option" data-md-color-accent="purple" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-primary="cyan" data-md-color-scheme="slate" id="__palette_1" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_0" hidden="" title="Nerve Center">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="m19.07 4.93-1.41 1.41A8.01 8.01 0 0 1 20 12a8 8 0 0 1-8 8 8 8 0 0 1-8-8c0-4.08 3.05-7.44 7-7.93v2.02C8.16 6.57 6 9.03 6 12a6 6 0 0 0 6 6 6 6 0 0 0 6-6c0-1.66-.67-3.16-1.76-4.24l-1.41 1.41C15.55 9.9 16 10.9 16 12a4 4 0 0 1-4 4 4 4 0 0 1-4-4c0-1.86 1.28-3.41 3-3.86v2.14c-.6.35-1 .98-1 1.72a2 2 0 0 0 2 2 2 2 0 0 0 2-2c0-.74-.4-1.38-1-1.72V2h-1A10 10 0 0 0 2 12a10 10 0 0 0 10 10 10 10 0 0 0 10-10c0-2.76-1.12-5.26-2.93-7.07"></path></svg>
</label>
</form>
<script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
<label class="md-header__button md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="Search" required="" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg>
</label>
<nav aria-label="Search" class="md-search__options">
<button aria-label="Clear" class="md-search__icon md-icon" tabindex="-1" title="Clear" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg>
</button>
</nav>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="" tabindex="0">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            Initializing search
          </div>
<ol class="md-search-result__list" role="presentation"></ol>
</div>
</div>
</div>
</div>
</div>
<div class="md-header__source">
<a class="md-source" data-md-component="source" href="https://github.com/ovn-org/ovn-kubernetes" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"></path></svg>
</div>
<div class="md-source__repository">
    ovn-org/ovn-kubernetes
  </div>
</a>
</div>
</nav>
<nav aria-label="Tabs" class="md-tabs" data-md-component="tabs">
<div class="md-grid">
<ul class="md-tabs__list">
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../..">
          
  
  
    
  
  Overview

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../../installation/launching-ovn-kubernetes-on-kind/">
          
  
  
    
  
  Getting Started

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../../governance/CONTRIBUTING/">
          
  
  
    
  
  Developer Guide

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../../api-reference/introduction/">
          
  
  
    
  
  API Reference Guide

        </a>
</li>
<li class="md-tabs__item md-tabs__item--active">
<a class="md-tabs__link" href="../../user-defined-networks/user-defined-networks/">
          
  
  
    
  
  Features

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../../troubleshooting/debugging/">
          
  
  
    
  
  Troubleshooting

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../../observability/metrics/">
          
  
  
    
  
  Observability

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../../okeps/okep-5085-localnet-api/">
          
  
  
    
  
  Enhancement Proposals

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../../blog/">
          
  
  
    
  
  Blog

        </a>
</li>
</ul>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Navigation" class="md-nav md-nav--primary md-nav--lifted" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="OVN-Kubernetes" class="md-nav__button md-logo" data-md-component="logo" href="../../.." title="OVN-Kubernetes">
<img alt="logo" src="../../../images/ovn-inside-k8s.png"/>
</a>
    OVN-Kubernetes
  </label>
<div class="md-nav__source">
<a class="md-source" data-md-component="source" href="https://github.com/ovn-org/ovn-kubernetes" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"></path></svg>
</div>
<div class="md-source__repository">
    ovn-org/ovn-kubernetes
  </div>
</a>
</div>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_1" type="checkbox"/>
<div class="md-nav__link md-nav__container">
<a class="md-nav__link" href="../../..">
<span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
</a>
<label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_1_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_1">
<span class="md-nav__icon md-icon"></span>
            
  
    Overview
  

          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../design/architecture/">
<span class="md-ellipsis">
    
  
    Architecture
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../design/topology/">
<span class="md-ellipsis">
    
  
    Network Topology
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../design/gateway-modes/">
<span class="md-ellipsis">
    
  
    Gateway Modes
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../design/traffic-flows/">
<span class="md-ellipsis">
    
  
    Traffic Flows
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../design/pod-creation-workflow/">
<span class="md-ellipsis">
    
  
    Pod Creation Workflow
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../design/service-creation-workflow/">
<span class="md-ellipsis">
    
  
    Service Creation Workflow
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../design/service-traffic-policy/">
<span class="md-ellipsis">
    
  
    Service Traffic Policy
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../design/host-to-node-port-hairpin-trafficflow/">
<span class="md-ellipsis">
    
  
    Host To NodePort Hairpin
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../design/external-ip-and-loadbalancer-ingress/">
<span class="md-ellipsis">
    
  
    ExternalIPs/LoadBalancerIngress
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../design/ovn-kubernetes-subnets/">
<span class="md-ellipsis">
    
  
    Internal Subnets
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../live-migration/">
<span class="md-ellipsis">
    
  
    Kubevirt VM Live Migration
  

    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
<span class="md-ellipsis">
    
  
    Getting Started
  

    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_2_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_2">
<span class="md-nav__icon md-icon"></span>
            
  
    Getting Started
  

          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../installation/launching-ovn-kubernetes-on-kind/">
<span class="md-ellipsis">
    
  
    Launching OVN-Kubernetes
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../installation/launching-ovn-kubernetes-with-helm/">
<span class="md-ellipsis">
    
  
    Launching OVN-Kubernetes Using Helm
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../getting-started/configuration/">
<span class="md-ellipsis">
    
  
    Configuration Guide
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../getting-started/cli-guide/">
<span class="md-ellipsis">
    
  
    CLI Guide
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../getting-started/example-pod-creation/">
<span class="md-ellipsis">
    
  
    Deploying Workloads on OVN-Kubernetes cluster
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../getting-started/example-service-creation/">
<span class="md-ellipsis">
    
  
    Deploying Services on OVN-Kubernetes cluster
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../getting-started/building-ovn-kubernetes/">
<span class="md-ellipsis">
    
  
    Setup and Building
  

    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
<span class="md-ellipsis">
    
  
    Developer Guide
  

    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_3">
<span class="md-nav__icon md-icon"></span>
            
  
    Developer Guide
  

          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../governance/CONTRIBUTING/">
<span class="md-ellipsis">
    
  
    Contributing Guide
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../governance/REVIEWING/">
<span class="md-ellipsis">
    
  
    Reviewing Guide
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../developer-guide/developer/">
<span class="md-ellipsis">
    
  
    Coding Guide
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../developer-guide/image-build/">
<span class="md-ellipsis">
    
  
    OVN-Kubernetes Container Images
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../developer-guide/documentation/">
<span class="md-ellipsis">
    
  
    Documentation Guide
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../developer-guide/local_testing_guide/">
<span class="md-ellipsis">
    
  
    Local Testing Guide
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../ci/ci/">
<span class="md-ellipsis">
    
  
    CI Testing Guide
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../developer-guide/debugging/">
<span class="md-ellipsis">
    
  
    Debugging
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../developer-guide/release/">
<span class="md-ellipsis">
    
  
    Release Guide
  

    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_4" type="checkbox"/>
<label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
<span class="md-ellipsis">
    
  
    API Reference Guide
  

    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_4_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_4">
<span class="md-nav__icon md-icon"></span>
            
  
    API Reference Guide
  

          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../api-reference/introduction/">
<span class="md-ellipsis">
    
  
    Introduction
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../api-reference/egress-ip-api-spec/">
<span class="md-ellipsis">
    
  
    EgressIP
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../api-reference/egress-service-api-spec/">
<span class="md-ellipsis">
    
  
    EgressService
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../api-reference/egress-qos-api-spec/">
<span class="md-ellipsis">
    
  
    EgressQoS
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../api-reference/egress-firewall-api-spec/">
<span class="md-ellipsis">
    
  
    EgressFirewall
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../api-reference/admin-epbr-api-spec/">
<span class="md-ellipsis">
    
  
    AdminPolicyBasedExternalRoutes
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../api-reference/userdefinednetwork-api-spec/">
<span class="md-ellipsis">
    
  
    UserDefinedNetwork
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../api-reference/routeadvertisements-api-spec/">
<span class="md-ellipsis">
    
  
    RouteAdvertisements
  

    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_5" type="checkbox"/>
<label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="">
<span class="md-ellipsis">
    
  
    Features
  

    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="true" aria-labelledby="__nav_5_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_5">
<span class="md-nav__icon md-icon"></span>
            
  
    Features
  

          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--section md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_5_1" type="checkbox"/>
<label class="md-nav__link" for="__nav_5_1" id="__nav_5_1_label" tabindex="">
<span class="md-ellipsis">
    
  
    Universal Connectivity
  

    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_5_1_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_5_1">
<span class="md-nav__icon md-icon"></span>
            
  
    Universal Connectivity
  

          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../user-defined-networks/user-defined-networks/">
<span class="md-ellipsis">
    
  
    UserDefinedNetwork
  

    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--section md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_5_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_5_2" id="__nav_5_2_label" tabindex="">
<span class="md-ellipsis">
    
  
    NetworkSecurityControls
  

    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_5_2_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_5_2">
<span class="md-nav__icon md-icon"></span>
            
  
    NetworkSecurityControls
  

          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../network-security-controls/admin-network-policy/">
<span class="md-ellipsis">
    
  
    AdminNetworkPolicy
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../network-security-controls/network-policy/">
<span class="md-ellipsis">
    
  
    NetworkPolicy
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../network-security-controls/egress-firewall/">
<span class="md-ellipsis">
    
  
    EgressFirewall
  

    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--section md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_5_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_5_3" id="__nav_5_3_label" tabindex="">
<span class="md-ellipsis">
    
  
    ClusterEgressControls
  

    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_5_3_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_5_3">
<span class="md-nav__icon md-icon"></span>
            
  
    ClusterEgressControls
  

          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../cluster-egress-controls/egress-ip/">
<span class="md-ellipsis">
    
  
    EgressIP
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../cluster-egress-controls/egress-service/">
<span class="md-ellipsis">
    
  
    EgressService
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../cluster-egress-controls/egress-qos/">
<span class="md-ellipsis">
    
  
    EgressQoS
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../cluster-egress-controls/egress-gateway/">
<span class="md-ellipsis">
    
  
    EgressGateway
  

    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--section md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_5_4" type="checkbox"/>
<label class="md-nav__link" for="__nav_5_4" id="__nav_5_4_label" tabindex="">
<span class="md-ellipsis">
    
  
    InfrastructureSecurityControls
  

    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_5_4_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_5_4">
<span class="md-nav__icon md-icon"></span>
            
  
    InfrastructureSecurityControls
  

          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../infrastructure-security-controls/node-identity/">
<span class="md-ellipsis">
    
  
    NodeIdentity
  

    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_5_5" type="checkbox"/>
<label class="md-nav__link" for="__nav_5_5" id="__nav_5_5_label" tabindex="">
<span class="md-ellipsis">
    
  
    MultiNetworking
  

    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="true" aria-labelledby="__nav_5_5_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_5_5">
<span class="md-nav__icon md-icon"></span>
            
  
    MultiNetworking
  

          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
<span class="md-ellipsis">
    
  
    Multihoming
  

    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<a class="md-nav__link md-nav__link--active" href="./">
<span class="md-ellipsis">
    
  
    Multihoming
  

    
  </span>
</a>
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#introduction">
<span class="md-ellipsis">
      
        Introduction
      
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#prerequisites">
<span class="md-ellipsis">
      
        Prerequisites
      
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#motivation">
<span class="md-ellipsis">
      
        Motivation
      
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#user-stories">
<span class="md-ellipsis">
      
        User-Stories
      
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#user-cases">
<span class="md-ellipsis">
      
        User-Cases
      
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#how-to-enable-this-feature-on-an-ovn-kubernetes-cluster">
<span class="md-ellipsis">
      
        How to enable this feature on an OVN-Kubernetes cluster?
      
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#workflow-description">
<span class="md-ellipsis">
      
        Workflow Description
      
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#implementation-details">
<span class="md-ellipsis">
      
        Implementation Details
      
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#user-facing-api-changes">
<span class="md-ellipsis">
      
        User facing API Changes
      
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ovn-kubernetes-implementation-details">
<span class="md-ellipsis">
      
        OVN-Kubernetes Implementation Details
      
    </span>
</a>
<nav aria-label="OVN-Kubernetes Implementation Details" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#routed-layer-3-topology">
<span class="md-ellipsis">
      
        Routed - layer 3 - topology
      
    </span>
</a>
<nav aria-label="Routed - layer 3 - topology" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#network-configuration-reference">
<span class="md-ellipsis">
      
        Network Configuration reference:
      
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#switched-layer-2-topology">
<span class="md-ellipsis">
      
        Switched - layer 2 - topology
      
    </span>
</a>
<nav aria-label="Switched - layer 2 - topology" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#network-configuration-reference_1">
<span class="md-ellipsis">
      
        Network Configuration reference
      
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#switched-localnet-topology">
<span class="md-ellipsis">
      
        Switched - localnet - topology
      
    </span>
</a>
<nav aria-label="Switched - localnet - topology" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#network-configuration-reference_2">
<span class="md-ellipsis">
      
        Network Configuration reference
      
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#setting-a-secondary-network-on-the-pod">
<span class="md-ellipsis">
      
        Setting a secondary-network on the pod
      
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#setting-static-ip-addresses-on-a-pod">
<span class="md-ellipsis">
      
        Setting static IP addresses on a pod
      
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#multiple-interfaces-on-the-same-network">
<span class="md-ellipsis">
      
        Multiple interfaces on the same network
      
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#persistent-ip-addresses-for-virtualization-workloads">
<span class="md-ellipsis">
      
        Persistent IP addresses for virtualization workloads
      
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ipv4-and-ipv6-dynamic-configuration-for-virtualization-workloads-on-l2-primary-udn">
<span class="md-ellipsis">
      
        IPv4 and IPv6 dynamic configuration for virtualization workloads on L2 primary UDN
      
    </span>
</a>
<nav aria-label="IPv4 and IPv6 dynamic configuration for virtualization workloads on L2 primary UDN" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#configuring-dns-server">
<span class="md-ellipsis">
      
        Configuring dns server
      
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#limitations">
<span class="md-ellipsis">
      
        Limitations
      
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../multi-network-policies/">
<span class="md-ellipsis">
    
  
    MultiNetworkPolicies
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../multi-vtep/">
<span class="md-ellipsis">
    
  
    MultiNetworkRails
  

    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../multicast/">
<span class="md-ellipsis">
    
  
    Multicast
  

    
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--section md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_5_7" type="checkbox"/>
<label class="md-nav__link" for="__nav_5_7" id="__nav_5_7_label" tabindex="">
<span class="md-ellipsis">
    
  
    NetworkQoS
  

    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_5_7_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_5_7">
<span class="md-nav__icon md-icon"></span>
            
  
    NetworkQoS
  

          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../network-qos/">
<span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../network-qos-guide/">
<span class="md-ellipsis">
    
  
    Usage Guide
  

    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../live-migration/">
<span class="md-ellipsis">
    
  
    Kubevirt VM Live Migration
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../hybrid-overlay/">
<span class="md-ellipsis">
    
  
    HybridOverlay
  

    
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--section md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_5_10" type="checkbox"/>
<label class="md-nav__link" for="__nav_5_10" id="__nav_5_10_label" tabindex="">
<span class="md-ellipsis">
    
  
    Hardware Acceleration
  

    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_5_10_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_5_10">
<span class="md-nav__icon md-icon"></span>
            
  
    Hardware Acceleration
  

          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../hardware-offload/ovs-kernel/">
<span class="md-ellipsis">
    
  
    OVS Acceleration with kernel datapath
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../hardware-offload/ovs-doca/">
<span class="md-ellipsis">
    
  
    OVS Acceleration with DOCA datapath
  

    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--section md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_5_11" type="checkbox"/>
<label class="md-nav__link" for="__nav_5_11" id="__nav_5_11_label" tabindex="">
<span class="md-ellipsis">
    
  
    BGP Integration
  

    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_5_11_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_5_11">
<span class="md-nav__icon md-icon"></span>
            
  
    BGP Integration
  

          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../bgp-integration/route-advertisements/">
<span class="md-ellipsis">
    
  
    Route Advertisements
  

    
  </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_6" type="checkbox"/>
<label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
<span class="md-ellipsis">
    
  
    Troubleshooting
  

    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_6_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_6">
<span class="md-nav__icon md-icon"></span>
            
  
    Troubleshooting
  

          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../troubleshooting/debugging/">
<span class="md-ellipsis">
    
  
    Introduction
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../troubleshooting/ovnkube-trace/">
<span class="md-ellipsis">
    
  
    OVNKube Trace
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../troubleshooting/logging/">
<span class="md-ellipsis">
    
  
    Logging
  

    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_7" type="checkbox"/>
<label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
<span class="md-ellipsis">
    
  
    Observability
  

    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_7_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_7">
<span class="md-nav__icon md-icon"></span>
            
  
    Observability
  

          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../observability/metrics/">
<span class="md-ellipsis">
    
  
    Metrics
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../observability/sdn-dashboard/">
<span class="md-ellipsis">
    
  
    SDN Dashboard
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../observability/ovn-observability/">
<span class="md-ellipsis">
    
  
    OVN observability
  

    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_8" type="checkbox"/>
<label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
<span class="md-ellipsis">
    
  
    Enhancement Proposals
  

    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_8_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_8">
<span class="md-nav__icon md-icon"></span>
            
  
    Enhancement Proposals
  

          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../okeps/okep-5085-localnet-api/">
<span class="md-ellipsis">
    
  
    Localnet API
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../okeps/okep-4380-network-qos/">
<span class="md-ellipsis">
    
  
    Network QoS
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../okeps/okep-5193-user-defined-networks/">
<span class="md-ellipsis">
    
  
    User Defined Networks
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../okeps/okep-5233-preconfigured-udn-addresses/">
<span class="md-ellipsis">
    
  
    Preconfigured UDN Addresses
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../okeps/okep-5296-bgp/">
<span class="md-ellipsis">
    
  
    BGP
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../okeps/okep-5094-layer2-transit-router/">
<span class="md-ellipsis">
    
  
    Layer2TransitRouter
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../okeps/okep-5494-ovn-kubernetes-mcp-server/">
<span class="md-ellipsis">
    
  
    MCP for Troubleshooting
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../okeps/okep-5552-dynamic-udn-node-allocation/">
<span class="md-ellipsis">
    
  
    Dynamic UDN Node Allocation
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../okeps/okep-5224-connecting-udns/okep-5224-connecting-udns/">
<span class="md-ellipsis">
    
  
    Connecting User Defined Networks
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../okeps/okep-5259-no-overlay/">
<span class="md-ellipsis">
    
  
    No-Overlay Mode
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../okeps/okep-5088-evpn/">
<span class="md-ellipsis">
    
  
    EVPN
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../okeps/okep-5674-dpu-healthcheck/">
<span class="md-ellipsis">
    
  
    DPU Healthcheck
  

    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_9" type="checkbox"/>
<div class="md-nav__link md-nav__container">
<a class="md-nav__link" href="../../../blog/">
<span class="md-ellipsis">
    
  
    Blog
  

    
  </span>
</a>
<label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_9_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_9">
<span class="md-nav__icon md-icon"></span>
            
  
    Blog
  

          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../..">
<span class="md-ellipsis">
    
  
    Archive
  

    
  </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#introduction">
<span class="md-ellipsis">
      
        Introduction
      
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#prerequisites">
<span class="md-ellipsis">
      
        Prerequisites
      
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#motivation">
<span class="md-ellipsis">
      
        Motivation
      
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#user-stories">
<span class="md-ellipsis">
      
        User-Stories
      
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#user-cases">
<span class="md-ellipsis">
      
        User-Cases
      
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#how-to-enable-this-feature-on-an-ovn-kubernetes-cluster">
<span class="md-ellipsis">
      
        How to enable this feature on an OVN-Kubernetes cluster?
      
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#workflow-description">
<span class="md-ellipsis">
      
        Workflow Description
      
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#implementation-details">
<span class="md-ellipsis">
      
        Implementation Details
      
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#user-facing-api-changes">
<span class="md-ellipsis">
      
        User facing API Changes
      
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ovn-kubernetes-implementation-details">
<span class="md-ellipsis">
      
        OVN-Kubernetes Implementation Details
      
    </span>
</a>
<nav aria-label="OVN-Kubernetes Implementation Details" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#routed-layer-3-topology">
<span class="md-ellipsis">
      
        Routed - layer 3 - topology
      
    </span>
</a>
<nav aria-label="Routed - layer 3 - topology" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#network-configuration-reference">
<span class="md-ellipsis">
      
        Network Configuration reference:
      
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#switched-layer-2-topology">
<span class="md-ellipsis">
      
        Switched - layer 2 - topology
      
    </span>
</a>
<nav aria-label="Switched - layer 2 - topology" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#network-configuration-reference_1">
<span class="md-ellipsis">
      
        Network Configuration reference
      
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#switched-localnet-topology">
<span class="md-ellipsis">
      
        Switched - localnet - topology
      
    </span>
</a>
<nav aria-label="Switched - localnet - topology" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#network-configuration-reference_2">
<span class="md-ellipsis">
      
        Network Configuration reference
      
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#setting-a-secondary-network-on-the-pod">
<span class="md-ellipsis">
      
        Setting a secondary-network on the pod
      
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#setting-static-ip-addresses-on-a-pod">
<span class="md-ellipsis">
      
        Setting static IP addresses on a pod
      
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#multiple-interfaces-on-the-same-network">
<span class="md-ellipsis">
      
        Multiple interfaces on the same network
      
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#persistent-ip-addresses-for-virtualization-workloads">
<span class="md-ellipsis">
      
        Persistent IP addresses for virtualization workloads
      
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ipv4-and-ipv6-dynamic-configuration-for-virtualization-workloads-on-l2-primary-udn">
<span class="md-ellipsis">
      
        IPv4 and IPv6 dynamic configuration for virtualization workloads on L2 primary UDN
      
    </span>
</a>
<nav aria-label="IPv4 and IPv6 dynamic configuration for virtualization workloads on L2 primary UDN" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#configuring-dns-server">
<span class="md-ellipsis">
      
        Configuring dns server
      
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#limitations">
<span class="md-ellipsis">
      
        Limitations
      
    </span>
</a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<nav aria-label="Navigation" class="md-path">
<ol class="md-path__list">
<li class="md-path__item">
<a class="md-path__link" href="../../user-defined-networks/user-defined-networks/">
<span class="md-ellipsis">
    Features
  </span>
</a>
</li>
<li class="md-path__item">
<a class="md-path__link" href="./">
<span class="md-ellipsis">
    MultiNetworking
  </span>
</a>
</li>
</ol>
</nav>
<article class="md-content__inner md-typeset">
<h1 id="multihoming">Multihoming<a class="headerlink" href="#multihoming" title="Permanent link">¶</a></h1>
<h2 id="introduction">Introduction<a class="headerlink" href="#introduction" title="Permanent link">¶</a></h2>
<p>Multihoming allows the configuration of secondary-network interfaces for K8s pods.
OVN-Kubernetes secondary-network has three configurable topologies: layer 3, layer 2, or localnet.</p>
<ul>
<li>A layer 3 topology is a simplification of the topology for the cluster default network - but without egress.</li>
<li>A layer 2 topology provides an isolated (no egress) cluster-wide layer2 network providing east-west traffic to the
  cluster workloads.</li>
<li>A localnet topology is based on layer 2 topology, but also allows connecting to an existent (configured) physical
  network to provide north-south traffic to the workloads.</li>
</ul>
<p>For layer 2 and localnet topologies, multihoming also allows IP features on secondary interfaces such as static IP
allocation and persistent IP addresses for virtualization workloads.</p>
<p>To allow pods to have multiple network interfaces, the user must provide the
configurations specifying how to connect to these networks; these
configurations are defined in a CRD named <code>NetworkAttachmentDefinition</code>, defined by
the <a href="https://github.com/k8snetworkplumbingwg/multi-net-spec">Kubernetes Network Custom Resource Definition De-facto Standard</a>.</p>
<blockquote>
<p>[!NOTE]
layer 2 and layer 3 topologies are overlays - thus, they do not need <strong>any</strong> previous physical network configuration.</p>
</blockquote>
<h2 id="prerequisites">Prerequisites<a class="headerlink" href="#prerequisites" title="Permanent link">¶</a></h2>
<ul>
<li><a href="https://github.com/k8snetworkplumbingwg/multus-cni">multus-cni</a></li>
</ul>
<h2 id="motivation">Motivation<a class="headerlink" href="#motivation" title="Permanent link">¶</a></h2>
<p>Multihoming is essential when you need more than one network interface on your pods. This can be useful for various
use cases, such as virtual network functions (VNFs), firewalls, or virtualization (virt) where the default
cluster network might not be suitable.</p>
<p>In OVN-K, multihoming supports several virt-specific features. These
include <a href="#persistent-ip-addresses-for-virtualization-workloads">persistent IP addresses for virtualization</a> workloads,
ensuring that VMs retain their IP addresses even when they move across nodes. This enhances workload mobility and
minimizes disruptions.</p>
<p>Multihoming is also compatible with the <a href="../multi-network-policies/">multi-network policy</a> API, which can provide further security rules on the
traffic.</p>
<h2 id="user-stories">User-Stories<a class="headerlink" href="#user-stories" title="Permanent link">¶</a></h2>
<ul>
<li>As a Cluster-Admin, I want to configure secondary networks for specific pods so that I can enable
  specialized/sensitive workloads with distinct network requirements.</li>
<li>As a Cluster-Admin, I want to facilitate seamless live migration of VMs within so that I can maintain established TCP
  connections and preserve VM IP configurations during migration.</li>
</ul>
<h2 id="user-cases">User-Cases<a class="headerlink" href="#user-cases" title="Permanent link">¶</a></h2>
<ul>
<li>cluster-wide overlay network on layer 2:
  In this case example, two VMs from different namespaces - VMA and VMC - are connected over a secondary-network.
  VMB is not exposed to this traffic.
  <img alt="multi-homing-use-case-layer2" src="../multi-homing-use-case-layer2.png"/></li>
<li>cluster-wide localnet network:
  In this case example, Pod and VM workloads accessing a relational DB reachable via the physical network (i.e. deployed
  outside Kubernetes).
  <img alt="multi-homing-use-case-localnet" src="../multi-homing-use-case-localnet.png"/></li>
</ul>
<h2 id="how-to-enable-this-feature-on-an-ovn-kubernetes-cluster">How to enable this feature on an OVN-Kubernetes cluster?<a class="headerlink" href="#how-to-enable-this-feature-on-an-ovn-kubernetes-cluster" title="Permanent link">¶</a></h2>
<p>The <code>multi-network</code> feature must be enabled in the OVN-Kubernetes configuration.
Please use the <code>Feature Config</code> option <code>enable-multi-network</code> under <code>OVNKubernetesFeatureConfig</code> config to enable it.</p>
<h2 id="workflow-description">Workflow Description<a class="headerlink" href="#workflow-description" title="Permanent link">¶</a></h2>
<p>After a pod is scheduled on a particular Kubernetes node, kubelet will invoke
the meta-plugin installed on the cluster (such as <a href="https://github.com/k8snetworkplumbingwg/multus-cni">Multus</a>) to
prepare the pod for networking.
The meta-plugin will invoke the CNI responsible for setting up the pod's default cluster network.
After that, the meta-plugin iterates the list of secondary networks, invoking the corresponding CNI implementing
the logic to attach the pod to that particular secondary-network. The CNI will use the details specified on
the <code>network-attachment-definition</code> in order to do that.</p>
<blockquote>
<p>[!NOTE]
networks are <strong>not</strong> namespaced - i.e. creating multiple <code>network-attachment-definition</code>s with different
  configurations pointing at the same network (same <code>NetConf.Name</code> attribute) is <strong>not</strong> supported.</p>
</blockquote>
<h2 id="implementation-details">Implementation Details<a class="headerlink" href="#implementation-details" title="Permanent link">¶</a></h2>
<h2 id="user-facing-api-changes">User facing API Changes<a class="headerlink" href="#user-facing-api-changes" title="Permanent link">¶</a></h2>
<p>There are no user facing API Changes.</p>
<h2 id="ovn-kubernetes-implementation-details">OVN-Kubernetes Implementation Details<a class="headerlink" href="#ovn-kubernetes-implementation-details" title="Permanent link">¶</a></h2>
<p>Below you will find example attachment configurations for each of the current topologies OVN-K allows for secondary
networks.</p>
<h3 id="routed-layer-3-topology">Routed - layer 3 - topology<a class="headerlink" href="#routed-layer-3-topology" title="Permanent link">¶</a></h3>
<p>This topology is a simplification of the topology for the cluster default
network - but without egress.</p>
<p>There is a logical switch per node - each with a different subnet - and a
router interconnecting all the logical switches.</p>
<p>The following net-attach-def configures the attachment to a routed secondary
network.</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">k8s.cni.cncf.io/v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">NetworkAttachmentDefinition</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">l3-network</span>
<span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ns1</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">config</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|2</span>
<span class="w">    </span><span class="no">{</span>
<span class="w">            </span><span class="no">"cniVersion": "1.0.0",</span>
<span class="w">            </span><span class="no">"name": "tenantblue",</span>
<span class="w">            </span><span class="no">"type": "ovn-k8s-cni-overlay",</span>
<span class="w">            </span><span class="no">"topology":"layer3",</span>
<span class="w">            </span><span class="no">"subnets": "10.128.0.0/16/24",</span>
<span class="w">            </span><span class="no">"mtu": 1300,</span>
<span class="w">            </span><span class="no">"netAttachDefName": "ns1/l3-network"</span>
<span class="w">    </span><span class="no">}</span>
</code></pre></div>
<h4 id="network-configuration-reference">Network Configuration reference:<a class="headerlink" href="#network-configuration-reference" title="Permanent link">¶</a></h4>
<ul>
<li><code>name</code> (string, required): the name of the network. This attribute is <strong>not</strong> namespaced.</li>
<li><code>type</code> (string, required): "ovn-k8s-cni-overlay".</li>
<li><code>topology</code> (string, required): "layer3".</li>
<li><code>subnets</code> (string, required): a comma separated list of subnets. When multiple subnets
  are provided, the user will get an IP from each subnet.</li>
<li><code>mtu</code> (integer, optional): explicitly set MTU to the specified value. Defaults to the value chosen by the kernel.</li>
<li><code>netAttachDefName</code> (string, required): must match <code>&lt;namespace&gt;/&lt;net-attach-def name&gt;</code>
  of the surrounding object.</li>
</ul>
<blockquote>
<p>[!NOTE]
the <code>subnets</code> attribute indicates both the subnet across the cluster, and per node.
  The example above means you have a /16 subnet for the network, but each <strong>node</strong> has
  a /24 subnet.</p>
<p>[!NOTE]
routed - layer3 - topology networks <strong>only</strong> allow for east/west traffic.</p>
</blockquote>
<h3 id="switched-layer-2-topology">Switched - layer 2 - topology<a class="headerlink" href="#switched-layer-2-topology" title="Permanent link">¶</a></h3>
<p>This topology interconnects the workloads via a cluster-wide logical switch.</p>
<p>The following net-attach-def configures the attachment to a layer 2 secondary
network.</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">k8s.cni.cncf.io/v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">NetworkAttachmentDefinition</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">l2-network</span>
<span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ns1</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">config</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|2</span>
<span class="w">    </span><span class="no">{</span>
<span class="w">            </span><span class="no">"cniVersion": "1.0.0",</span>
<span class="w">            </span><span class="no">"name": "tenantyellow",</span>
<span class="w">            </span><span class="no">"type": "ovn-k8s-cni-overlay",</span>
<span class="w">            </span><span class="no">"topology":"layer2",</span>
<span class="w">            </span><span class="no">"subnets": "10.100.200.0/24",</span>
<span class="w">            </span><span class="no">"mtu": 1300,</span>
<span class="w">            </span><span class="no">"netAttachDefName": "ns1/l2-network",</span>
<span class="w">            </span><span class="no">"excludeSubnets": "10.100.200.0/29"</span>
<span class="w">    </span><span class="no">}</span>
</code></pre></div>
<h4 id="network-configuration-reference_1">Network Configuration reference<a class="headerlink" href="#network-configuration-reference_1" title="Permanent link">¶</a></h4>
<ul>
<li><code>name</code> (string, required): the name of the network. This attribute is <strong>not</strong> namespaced.</li>
<li><code>type</code> (string, required): "ovn-k8s-cni-overlay".</li>
<li><code>topology</code> (string, required): "layer2".</li>
<li><code>subnets</code> (string, optional): a comma separated list of subnets. When multiple subnets
  are provided, the user will get an IP from each subnet.</li>
<li><code>mtu</code> (integer, optional): explicitly set MTU to the specified value. Defaults to the value chosen by the kernel.</li>
<li><code>netAttachDefName</code> (string, required): must match <code>&lt;namespace&gt;/&lt;net-attach-def name&gt;</code>
  of the surrounding object.</li>
<li><code>excludeSubnets</code> (string, optional): a comma separated list of CIDRs / IPs.
  These IPs will be removed from the assignable IP pool, and never handed over
  to the pods.</li>
<li><code>allowPersistentIPs</code> (boolean, optional): persist the OVN-Kubernetes assigned
  IP addresses in a <code>ipamclaims.k8s.cni.cncf.io</code> object. This IP addresses will
  be reused by other pods if requested. Useful for KubeVirt VMs. Only makes
  sense if the <code>subnets</code> attribute is also defined.</li>
</ul>
<blockquote>
<p>[!NOTE]
when the subnets attribute is omitted, the logical switch implementing the
  network will only provide layer 2 communication, and the users must configure
  IPs for the pods. Port security will only prevent MAC spoofing.</p>
<p>[!NOTE]
switched - layer2 - secondary networks <strong>only</strong> allow for east/west traffic.</p>
</blockquote>
<h3 id="switched-localnet-topology">Switched - localnet - topology<a class="headerlink" href="#switched-localnet-topology" title="Permanent link">¶</a></h3>
<p>This topology interconnects the workloads via a cluster-wide logical switch to
a physical network.</p>
<p>The following net-attach-def configures the attachment to a localnet secondary
network.</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">k8s.cni.cncf.io/v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">NetworkAttachmentDefinition</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">localnet-network</span>
<span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ns1</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">config</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|2</span>
<span class="w">    </span><span class="no">{</span>
<span class="w">            </span><span class="no">"cniVersion": "1.0.0",</span>
<span class="w">            </span><span class="no">"name": "tenantblack",</span>
<span class="w">            </span><span class="no">"type": "ovn-k8s-cni-overlay",</span>
<span class="w">            </span><span class="no">"topology":"localnet",</span>
<span class="w">            </span><span class="no">"subnets": "202.10.130.112/28",</span>
<span class="w">            </span><span class="no">"vlanID": 33,</span>
<span class="w">            </span><span class="no">"mtu": 1500,</span>
<span class="w">            </span><span class="no">"netAttachDefName": "ns1/localnet-network"</span>
<span class="w">    </span><span class="no">}</span>
</code></pre></div>
<p>Note that in order to connect to the physical network, it is expected that
ovn-bridge-mappings is configured appropriately on the chassis for this
localnet network.</p>
<h4 id="network-configuration-reference_2">Network Configuration reference<a class="headerlink" href="#network-configuration-reference_2" title="Permanent link">¶</a></h4>
<ul>
<li><code>name</code> (string, required): the name of the network.</li>
<li><code>type</code> (string, required): "ovn-k8s-cni-overlay".</li>
<li><code>topology</code> (string, required): "localnet".</li>
<li><code>subnets</code> (string, optional): a comma separated list of subnets. When multiple subnets
  are provided, the user will get an IP from each subnet.</li>
<li><code>mtu</code> (integer, optional): explicitly set MTU to the specified value. Defaults to the value chosen by the kernel.</li>
<li><code>netAttachDefName</code> (string, required): must match <code>&lt;namespace&gt;/&lt;net-attach-def name&gt;</code>
  of the surrounding object.</li>
<li><code>excludeSubnets</code> (string, optional): a comma separated list of CIDRs / IPs.
  These IPs will be removed from the assignable IP pool, and never handed over
  to the pods.</li>
<li><code>vlanID</code> (integer, optional): assign VLAN tag. Defaults to none.</li>
<li><code>allowPersistentIPs</code> (boolean, optional): persist the OVN-Kubernetes assigned
  IP addresses in a <code>ipamclaims.k8s.cni.cncf.io</code> object. This IP addresses will
  be reused by other pods if requested. Useful for KubeVirt VMs. Only makes
  sense if the <code>subnets</code> attribute is also defined.</li>
<li><code>physicalNetworkName</code> (string, optional): the name of the physical network to
  which the OVN overlay will connect. When omitted, it will default to the value
  of the localnet network name on the NAD's <code>.spec.config.name</code>.</li>
</ul>
<blockquote>
<p>[!NOTE]
when the subnets attribute is omitted, the logical switch implementing the
  network will only provide layer 2 communication, and the users must configure
  IPs for the pods. Port security will only prevent MAC spoofing.</p>
<p>[!NOTE]
updates to the network specification require the attached workloads restart. All the network-attachment-definitions 
  pointing to the same network must have a consistent configuration, and then workloads must be restarted.</p>
</blockquote>
<h3 id="setting-a-secondary-network-on-the-pod">Setting a secondary-network on the pod<a class="headerlink" href="#setting-a-secondary-network-on-the-pod" title="Permanent link">¶</a></h3>
<p>The user must specify the secondary-network attachments via the
<code>k8s.v1.cni.cncf.io/networks</code> annotation.</p>
<p>The following example provisions a pod with two secondary attachments, one for
each of the attachment configurations presented in
<a href="#configuring-secondary-networks">Configuring secondary networks</a>.</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Pod</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">annotations</span><span class="p">:</span>
<span class="w">    </span><span class="nt">k8s.v1.cni.cncf.io/networks</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">l3-network,l2-network</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tinypod</span>
<span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ns1</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">containers</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">args</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pause</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">registry.k8s.io/e2e-test-images/agnhost:2.36</span>
<span class="w">    </span><span class="nt">imagePullPolicy</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">IfNotPresent</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">agnhost-container</span>
</code></pre></div>
<h3 id="setting-static-ip-addresses-on-a-pod">Setting static IP addresses on a pod<a class="headerlink" href="#setting-static-ip-addresses-on-a-pod" title="Permanent link">¶</a></h3>
<p>The user can specify attachment parameters via
<a href="https://github.com/k8snetworkplumbingwg/network-attachment-definition-client/blob/63033d5c63d1cf56f924a5454c8f2ac444b6736d/pkg/apis/k8s.cni.cncf.io/v1/types.go#L137">network-selection-elements</a>,
namely IP, MAC, and interface name.</p>
<p>Refer to the following yaml for an example on how to request a static IP for a
pod, a MAC address, and specify the pod interface name.</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Pod</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">annotations</span><span class="p">:</span>
<span class="w">    </span><span class="nt">k8s.v1.cni.cncf.io/networks</span><span class="p">:</span><span class="w"> </span><span class="s">'[</span>
<span class="w">      </span><span class="s">{</span>
<span class="w">        </span><span class="s">"name":</span><span class="nv"> </span><span class="s">"l2-network",</span>
<span class="w">        </span><span class="s">"mac":</span><span class="nv"> </span><span class="s">"02:03:04:05:06:07",</span>
<span class="w">        </span><span class="s">"interface":</span><span class="nv"> </span><span class="s">"myiface1",</span>
<span class="w">        </span><span class="s">"ips":</span><span class="nv"> </span><span class="s">[</span>
<span class="w">          </span><span class="s">"192.0.2.20/24"</span>
<span class="w">        </span><span class="s">]</span>
<span class="w">      </span><span class="s">}</span>
<span class="w">    </span><span class="s">]'</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tinypod</span>
<span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ns1</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">containers</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">args</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pause</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">registry.k8s.io/e2e-test-images/agnhost:2.36</span>
<span class="w">    </span><span class="nt">imagePullPolicy</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">IfNotPresent</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">agnhost-container</span>
</code></pre></div>
<blockquote>
<p>[!NOTE]
the user can specify the IP address for a pod's secondary attachment
  <strong>only</strong> for an L2 or localnet attachment.</p>
<p>[!NOTE]
specifying a static IP address for the pod is only possible when the
  attachment configuration does <strong>not</strong> feature subnets.</p>
</blockquote>
<h3 id="multiple-interfaces-on-the-same-network">Multiple interfaces on the same network<a class="headerlink" href="#multiple-interfaces-on-the-same-network" title="Permanent link">¶</a></h3>
<p>OVN-Kubernetes supports attaching a pod to the same non-primary user-defined
network multiple times, allowing the pod to have multiple interfaces connected
to the same network. This is useful for workloads that require multiple network
interfaces on the same network for advanced networking scenarios. Note that only
layer 2 and layer 3 networks are supported.</p>
<p>To request multiple interfaces on the same network, specify the network
multiple times in the <code>k8s.v1.cni.cncf.io/networks</code> annotation:</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Pod</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">annotations</span><span class="p">:</span>
<span class="w">    </span><span class="nt">k8s.v1.cni.cncf.io/networks</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">l3-network,l3-network</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">multi-nic-pod</span>
<span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ns1</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">containers</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">args</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pause</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">registry.k8s.io/e2e-test-images/agnhost:2.36</span>
<span class="w">    </span><span class="nt">imagePullPolicy</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">IfNotPresent</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">agnhost-container</span>
</code></pre></div>
<p>In this example, the pod will have two interfaces both connected to the
<code>l3-network</code>. Each interface will receive its own IP address from the
network's subnet.</p>
<h3 id="persistent-ip-addresses-for-virtualization-workloads">Persistent IP addresses for virtualization workloads<a class="headerlink" href="#persistent-ip-addresses-for-virtualization-workloads" title="Permanent link">¶</a></h3>
<p>OVN-Kubernetes provides persistent IP addresses for virtualization workloads,
allowing VMs to have the same IP addresses when they migrate, when they restart,
and when they stop, the resume operation.</p>
<p>For that, the network admin must configure the network accordingly - the
<code>allowPersistentIPs</code> flag must be enabled in the NAD of the network. As with the
other network knobs, all NADs pointing to the same network <strong>must</strong> feature the
same configuration - i.e. all NADs in the network must either allow (or reject)
persistent IPs.</p>
<p>The client application (which creates the
VM, and manages its lifecycle) is
responsible for creating the <code>ipamclaims.k8s.cni.cncf.io</code> object, and point to
it in the network selection element upon pod creation;
OVN-Kubernetes will then persist the IP addresses it has allocated the pod in the <code>IPAMClaim</code>. This flow
is portrayed in the sequence diagram below.</p>
<pre class="mermaid"><code>sequenceDiagram
  actor user
  participant KubeVirt
  participant apiserver
  participant OVN-Kubernetes

  user-&gt;&gt;KubeVirt: createVM(name=vm-a)
  KubeVirt--&gt;&gt;user: OK

  KubeVirt-&gt;&gt;apiserver: createIPAMClaims(networks=...)
  apiserver--&gt;&gt;KubeVirt: OK

  KubeVirt-&gt;&gt;apiserver: createPOD(ipamClaims=...)
  apiserver--&gt;&gt;KubeVirt: OK

  apiserver-&gt;&gt;OVN-Kubernetes: reconcilePod(podKey=...)
  OVN-Kubernetes-&gt;&gt;OVN-Kubernetes: ips = AllocateNextIPs(nad.subnet)
  OVN-Kubernetes-&gt;&gt;apiserver: IPAMClaim.UpdateStatus(status.ips = ips)
  apiserver--&gt;&gt;OVN-Kubernetes: OK
</code></pre>
<p>Whenever a VM is migrated, restarted, or stopped / then started a new pod will
be scheduled to host the VM; it will also point to the same <code>IPAMClaim</code>s, and
OVN-Kubernetes will fulfill the IP addresses being requested by the client.
This flow is shown in the sequence diagram below.</p>
<pre class="mermaid"><code>sequenceDiagram
  actor user
  participant KubeVirt
  participant apiserver
  participant OVN-Kubernetes

  user-&gt;&gt;KubeVirt: startVM(vmName) or migrateVM(vmName)
  KubeVirt--&gt;&gt;user: OK

  note over KubeVirt: podName := "launcher-<vm name="">"
  KubeVirt-&gt;&gt;apiserver: createPod(name=podName, ipam-claims=...)
  apiserver--&gt;&gt;KubeVirt: OK

  apiserver-&gt;&gt;OVN-Kubernetes: reconcilePod(podKey=...)
  OVN-Kubernetes-&gt;&gt;OVN-Kubernetes: ipamClaim := readIPAMClaim(claimName)
  OVN-Kubernetes-&gt;&gt;OVN-Kubernetes: allocatePodIPs(ipamClaim.Status.IPs)
</vm></code></pre>
<p>Managing the life-cycle of the <code>IPAMClaim</code>s objects is the responsibility of the
client application that created them in the first place. In this case, KubeVirt.</p>
<p>This feature is described in detail in the following KubeVirt
<a href="https://github.com/kubevirt/community/pull/279">design proposal</a>.</p>
<h2 id="ipv4-and-ipv6-dynamic-configuration-for-virtualization-workloads-on-l2-primary-udn">IPv4 and IPv6 dynamic configuration for virtualization workloads on L2 primary UDN<a class="headerlink" href="#ipv4-and-ipv6-dynamic-configuration-for-virtualization-workloads-on-l2-primary-udn" title="Permanent link">¶</a></h2>
<p>For virtualization workloads using a primary UDN with layer2 topology ovn-k 
configure some DHCP and NDP flows to server ipv4 and ipv6 configuration for them.</p>
<p>For both ipv4 and ipv6 the following parameters are configured using DHCP or RAs:
- address
- gateway
- dns (read notes below)
- hostname (vm's name)
- mtu (taken from network attachment definition)</p>
<h3 id="configuring-dns-server">Configuring dns server<a class="headerlink" href="#configuring-dns-server" title="Permanent link">¶</a></h3>
<p>By default, the DHCP server at ovn-kubernetes will configure the kubernetes
default dns service <code>kube-system/kube-dns</code> as the name server. This can be
overridden with the following command line options:
- dns-service-namespace
- dns-service-name</p>
<h2 id="limitations">Limitations<a class="headerlink" href="#limitations" title="Permanent link">¶</a></h2>
<p>OVN-Kubernetes currently does <strong>not</strong> support:</p>
<ul>
<li>updates to the network selection elements lists - i.e. <code>k8s.v1.cni.cncf.io/networks</code> annotation</li>
<li>external IPAM - i.e. the user can't define the IPAM attribute in the configuration. They must use the subnets
  attribute.</li>
<li>IPv6 link local addresses not derived from the MAC address as described in RFC 2373, like  Privacy Extensions defined by RFC 4941, 
  or the Opaque Identifier generation methods defined in RFC 7217.</li>
</ul>
</article>
</div>
<script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
</div>
</main>
<footer class="md-footer">
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-copyright">
<div class="md-copyright__highlight">
      Copyright © OVN-Kubernetes a Series of LF Projects, LLC. For website terms of use, trademark policy and other project policies please see <a href="https://lfprojects.org/policies/">LF Projects Policies</a>.
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
      Material for MkDocs
    </a>
</div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<script id="__config" type="application/json">{"annotate": null, "base": "../../..", "features": ["navigation.instant", "navigation.tracking", "navigation.indexes", "navigation.tabs", "navigation.tabs.sticky", "navigation.sections", "navigation.expand", "navigation.path", "content.code.copy", "content.code.annotate", "content.tabs.link"], "search": "../../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
<script src="../../../assets/javascripts/bundle.79ae519e.min.js"></script>
<script src="../../../javascripts/gemini-api-key.js"></script>
<script src="../../../javascripts/theme.js"></script>
<script src="../../../javascripts/extra.js"></script>
<script type="module">import mermaid from "https://unpkg.com/mermaid@10.4.0/dist/mermaid.esm.min.mjs";
window.mermaidConfig = {default: {
    startOnLoad: false
}};</script></body>
</html>